# ASICç¡¬ä»¶ä¸Šçš„Indexå¼€é”€åˆ†æ

**åˆ›å»ºæ—¶é—´**: 2025-11-05
**æ ¸å¿ƒé—®é¢˜**: Quamba2çš„reorder indexåœ¨ASICå®ç°ä¸Šæœ‰å¤šå°‘ç¡¬ä»¶å¼€é”€ï¼Ÿ

---

## ğŸ¯ ASIC vs GPUçš„æ ¹æœ¬å·®å¼‚

### GPUå®ç°ç‰¹ç‚¹
- å¤§é‡SRAM (L1/L2 cache: æ•°MB)
- é€šç”¨è®¡ç®—å•å…ƒ
- åˆ†æ”¯é¢„æµ‹
- åŠ¨æ€è°ƒåº¦

### ASICå®ç°ç‰¹ç‚¹
- **ç‰‡ä¸Šå­˜å‚¨æ˜‚è´µ** (SRAMé¢ç§¯å¤§ï¼ŒåŠŸè€—é«˜)
- ä¸“ç”¨ç¡¬ä»¶ç”µè·¯
- æ— åˆ†æ”¯é¢„æµ‹ï¼ˆå›ºå®šæµæ°´çº¿ï¼‰
- é™æ€è°ƒåº¦

**å…³é”®å·®å¼‚**: åœ¨ASICä¸Šï¼Œ**å­˜å‚¨å¼€é”€è¿œæ¯”è®¡ç®—å¼€é”€é‡è¦**ï¼

---

## ğŸ’¾ ASICå­˜å‚¨å¼€é”€åˆ†æ

### Indexæ•°æ®é‡

**å•ä¸ªConv1Då±‚çš„Index**:
```
x_head_group_range:  (8, 4)     INT32 = 128 bytes
x_dim_group_range:   (8, 4, 4)  INT32 = 512 bytes
x_out_scales:        (8, 4, 4)  FP32  = 512 bytes
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
æ€»è®¡:                                  1152 bytes
```

**Mamba2-2.7Bæ¨¡å‹** (64å±‚):
```
æ€»Index+Scales: 1152 bytes Ã— 64 layers = 73,728 bytes â‰ˆ 72 KB
```

### ASICç‰‡ä¸Šå­˜å‚¨æˆæœ¬

#### 1. SRAMé¢ç§¯ä¼°ç®—

**å·¥è‰º**: å‡è®¾7nmå·¥è‰º

**SRAMå¯†åº¦**:
```
å…¸å‹å€¼: ~0.04 mmÂ²/KB (7nm, å•ç«¯å£SRAM)
é«˜å¯†åº¦: ~0.03 mmÂ²/KB (7nm, ä¼˜åŒ–å)
```

**Indexå­˜å‚¨é¢ç§¯**:
```
72 KB Ã— 0.04 mmÂ²/KB = 2.88 mmÂ²

å¯¹æ¯”:
- ä¸€ä¸ªGEMM MAC unit: ~0.001 mmÂ²
- 1ä¸ªSRAM KB: ~0.04 mmÂ²
- 72 KB SRAM: ~2.88 mmÂ²
- 2880ä¸ªMAC units: ~2.88 mmÂ²
```

**ç»“è®º**: **72 KB SRAM â‰ˆ 2880ä¸ªINT8 MACå•å…ƒçš„é¢ç§¯**

#### 2. åŠŸè€—ä¼°ç®—

**SRAMåŠŸè€—** (7nm):
```
è¯»å–åŠŸè€—: ~1-2 pJ/bit (read)
å†™å…¥åŠŸè€—: ~2-3 pJ/bit (write)
é™æ€åŠŸè€—: ~0.1 pJ/bit/cycle (leakage)
```

**Indexè®¿é—®åŠŸè€—**:
```
å•æ¬¡æŸ¥æ‰¾è¯»å–:
- x_head_group_range: 4 Ã— INT32 = 128 bits
- x_dim_group_range: 16 Ã— INT32 = 512 bits
- x_out_scales: 1 Ã— FP32 = 32 bits
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
æ€»è®¡: ~672 bits

åŠŸè€—: 672 bits Ã— 1.5 pJ/bit â‰ˆ 1 nJ per lookup
```

**å¯¹æ¯”Conv1Dä¸»è®¡ç®—åŠŸè€—**:
```
Conv1D (kernel_size=4, dim=2560):
- MACæ“ä½œ: 4 Ã— 2560 = 10,240 MACs
- INT8 MACåŠŸè€—: ~0.2 pJ/MAC (7nm)
- æ€»åŠŸè€—: 10,240 Ã— 0.2 pJ = 2048 pJ â‰ˆ 2 nJ

IndexæŸ¥æ‰¾: 1 nJ
Conv1Dè®¡ç®—: 2 nJ

ç›¸å¯¹å¼€é”€: 1 / 2 = 50% âš ï¸
```

**é‡è¦å‘ç°**: åœ¨ASICä¸Šï¼ŒindexæŸ¥æ‰¾çš„**åŠŸè€—å¼€é”€çº¦50%**ï¼

---

## âš™ï¸ ASICæŸ¥æ‰¾é€»è¾‘ç¡¬ä»¶å®ç°

### 1. é¡ºåºæŸ¥æ‰¾å®ç° (å½“å‰ä»£ç é€»è¾‘)

**ç¡¬ä»¶ç”µè·¯**:

```verilog
// ä¼ªä»£ç è¡¨ç¤ºæŸ¥æ‰¾é€»è¾‘
module scale_lookup (
    input [4:0] head_idx,      // 5-bit head index
    input [4:0] dim_idx,       // 5-bit dim index
    input [31:0] head_ranges[8][4],    // 8Ã—4 INT32
    input [31:0] dim_ranges[8][4][4],  // 8Ã—4Ã—4 INT32
    input [31:0] scales[8][4][4],      // 8Ã—4Ã—4 FP32
    output [31:0] scale_out
);

    // å¤–å±‚å¾ªç¯ï¼šæŸ¥æ‰¾head group (æœ€å¤š4æ¬¡æ¯”è¾ƒ)
    reg [1:0] hg_idx;
    reg found_head;

    for (hg_idx = 0; hg_idx < 4; hg_idx++) begin
        if (head_idx < head_ranges[group_idx][hg_idx]) begin
            found_head = 1;
            // å†…å±‚å¾ªç¯ï¼šæŸ¥æ‰¾dim group (æœ€å¤š4æ¬¡æ¯”è¾ƒ)
            reg [1:0] dg_idx;
            for (dg_idx = 0; dg_idx < 4; dg_idx++) begin
                if (dim_idx < dim_ranges[group_idx][hg_idx][dg_idx]) begin
                    scale_out = scales[group_idx][hg_idx][dg_idx];
                    break;
                end
            end
            break;
        end
    end
endmodule
```

**ç¡¬ä»¶æˆæœ¬**:

| ç»„ä»¶ | æ•°é‡ | å•å…ƒé¢ç§¯ | æ€»é¢ç§¯ | å¤‡æ³¨ |
|------|------|---------|--------|------|
| **æ¯”è¾ƒå™¨ (32-bit)** | 4 (å¤–å±‚) + 4 (å†…å±‚) | ~200 gates | ~1600 gates | Sequential |
| **Mux (32-bit)** | 8 (é€‰æ‹©scale) | ~100 gates | ~800 gates | - |
| **æ§åˆ¶é€»è¾‘** | 1 | ~500 gates | ~500 gates | FSM |
| **SRAMè¯»ç«¯å£** | 3ä¸ª32-bit | - | - | å¹¶è¡Œè¯»å– |
| **æ€»è®¡** | - | - | **~2900 gates** | ~0.001 mmÂ² (7nm) |

**æ—¶åº**:
```
æœ€åæƒ…å†µå»¶è¿Ÿ:
- 4æ¬¡å¤–å±‚æ¯”è¾ƒ Ã— (æ¯”è¾ƒå»¶è¿Ÿ + muxå»¶è¿Ÿ)
- 4æ¬¡å†…å±‚æ¯”è¾ƒ Ã— (æ¯”è¾ƒå»¶è¿Ÿ + muxå»¶è¿Ÿ)
- SRAMè¯»å–å»¶è¿Ÿ

å‡è®¾:
- æ¯”è¾ƒå™¨å»¶è¿Ÿ: ~0.5 ns (7nm)
- Muxå»¶è¿Ÿ: ~0.3 ns
- SRAMè¯»å»¶è¿Ÿ: ~1 ns

æ€»å»¶è¿Ÿ: 4Ã—(0.5+0.3) + 4Ã—(0.5+0.3) + 1 = 7.4 ns
```

**å…³é”®é—®é¢˜**: **é¡ºåºæŸ¥æ‰¾å»¶è¿Ÿé«˜ï¼Œå½±å“æµæ°´çº¿é¢‘ç‡ï¼**

---

### 2. å¹¶è¡ŒæŸ¥æ‰¾å®ç° (ä¼˜åŒ–æ–¹æ¡ˆ)

**ç¡¬ä»¶ç”µè·¯**:

```verilog
// å¹¶è¡ŒæŸ¥æ‰¾æ‰€æœ‰16ä¸ªscalesï¼Œç„¶åé€‰æ‹©
module parallel_scale_lookup (
    input [4:0] head_idx,
    input [4:0] dim_idx,
    input [31:0] scales[4][4],  // 16ä¸ªscales
    output [31:0] scale_out
);

    // 16ä¸ªå¹¶è¡Œæ¯”è¾ƒå™¨
    wire [15:0] match;
    genvar i, j;
    generate
        for (i = 0; i < 4; i++) begin
            for (j = 0; j < 4; j++) begin
                assign match[i*4+j] =
                    (head_idx in range[i]) && (dim_idx in range[i][j]);
            end
        end
    endgenerate

    // 16:1 Mux (one-hot select)
    assign scale_out = scales[match];

endmodule
```

**ç¡¬ä»¶æˆæœ¬**:

| ç»„ä»¶ | æ•°é‡ | å•å…ƒé¢ç§¯ | æ€»é¢ç§¯ | å¤‡æ³¨ |
|------|------|---------|--------|------|
| **æ¯”è¾ƒå™¨ (32-bit)** | 16 (å¹¶è¡Œ) | ~200 gates | ~3200 gates | **Parallel** |
| **Mux (16:1, 32-bit)** | 1 | ~400 gates | ~400 gates | One-hot |
| **Range checké€»è¾‘** | 16 | ~100 gates | ~1600 gates | - |
| **SRAMè¯»ç«¯å£** | å¤šç«¯å£ | - | **+50%é¢ç§¯** | Multi-port |
| **æ€»è®¡** | - | - | **~5200 gates + SRAM** | ~0.002 mmÂ² |

**æ—¶åº**:
```
å¹¶è¡ŒæŸ¥æ‰¾å»¶è¿Ÿ:
- 1æ¬¡å¹¶è¡Œæ¯”è¾ƒ: ~0.5 ns
- 16:1 Mux: ~0.5 ns
- SRAMè¯»å–: ~1 ns

æ€»å»¶è¿Ÿ: 0.5 + 0.5 + 1 = 2 ns âœ… æ¯”é¡ºåºå¿«3.7Ã—
```

**Trade-off**:
- âœ… å»¶è¿Ÿé™ä½ 3.7Ã—
- âŒ é¢ç§¯å¢åŠ  ~2Ã—
- âŒ åŠŸè€—å¢åŠ  (16ä¸ªå¹¶è¡Œæ¯”è¾ƒå™¨)

---

## ğŸ” ASICå®ç°çš„å…³é”®æƒè¡¡

### æ–¹æ¡ˆ1: Quamba2 (Piecewise Scale)

**å­˜å‚¨å¼€é”€**:
```
Index + Scales: 72 KB SRAM
é¢ç§¯: ~2.88 mmÂ²
åŠŸè€—: ~1 nJ per lookup (50% of Conv1D)
```

**æŸ¥æ‰¾é€»è¾‘**:
```
é¡ºåºæŸ¥æ‰¾:
  é¢ç§¯: ~0.001 mmÂ² (2900 gates)
  å»¶è¿Ÿ: ~7.4 ns

å¹¶è¡ŒæŸ¥æ‰¾:
  é¢ç§¯: ~0.002 mmÂ² (5200 gates)
  å»¶è¿Ÿ: ~2 ns
```

**æ€»æˆæœ¬** (é¡ºåºæŸ¥æ‰¾):
```
é¢ç§¯: 2.88 mmÂ² (SRAM) + 0.001 mmÂ² (é€»è¾‘) â‰ˆ 2.88 mmÂ²
åŠŸè€—: 1 nJ per lookup
å»¶è¿Ÿ: 7.4 ns (å¯èƒ½æˆä¸ºcritical path)
```

### æ–¹æ¡ˆ2: Quamba1 (Per-tensor Scale)

**å­˜å‚¨å¼€é”€**:
```
Scales only: 64 Ã— 4 bytes = 256 bytes
é¢ç§¯: ~0.01 mmÂ²
åŠŸè€—: ~0.01 nJ per lookup
```

**æŸ¥æ‰¾é€»è¾‘**:
```
ç›´æ¥è¯»å–:
  é¢ç§¯: å¯å¿½ç•¥
  å»¶è¿Ÿ: ~1 ns (SRAMè¯»å–)
```

**æ€»æˆæœ¬**:
```
é¢ç§¯: ~0.01 mmÂ² (SRAM only)
åŠŸè€—: ~0.01 nJ per lookup
å»¶è¿Ÿ: ~1 ns
```

### æ–¹æ¡ˆ3: Rotation (MambaQuant-style)

**å­˜å‚¨å¼€é”€**:
```
Rotation matrix: 2560Ã—2560 FP32 = 25.6 MB (å¤ªå¤§ï¼)
é€šå¸¸å­˜å‚¨åœ¨ç‰‡å¤–DRAM
```

**è®¡ç®—é€»è¾‘**:
```
çŸ©é˜µä¹˜æ³•: éœ€è¦å¤§é‡MACå•å…ƒ
é¢ç§¯: å‡è®¾256ä¸ªFP32 MAC = ~1 mmÂ²
åŠŸè€—: ~100 nJ per rotation (å·¨å¤§)
å»¶è¿Ÿ: ~100 ns (æµæ°´çº¿)
```

**æ€»æˆæœ¬**:
```
é¢ç§¯: ~1 mmÂ² (MAC array)
åŠŸè€—: ~100 nJ per operation
å»¶è¿Ÿ: ~100 ns
å­˜å‚¨: ç‰‡å¤–DRAM (å¸¦å®½ç“¶é¢ˆ)
```

---

## ğŸ“Š ASICå®ç°å¯¹æ¯”æ€»ç»“

### é¢ç§¯å¼€é”€

| æ–¹æ¡ˆ | SRAM | é€»è¾‘ | æ€»è®¡ | ç›¸å¯¹å€¼ |
|------|------|------|------|--------|
| **Quamba1** | 0.01 mmÂ² | ~0 | **0.01 mmÂ²** | 1Ã— |
| **Quamba2 (é¡ºåº)** | 2.88 mmÂ² | 0.001 mmÂ² | **2.88 mmÂ²** | **288Ã—** |
| **Quamba2 (å¹¶è¡Œ)** | 4.32 mmÂ² | 0.002 mmÂ² | **4.32 mmÂ²** | **432Ã—** |
| **Rotation** | Off-chip | 1 mmÂ² | **1 mmÂ² + DRAM** | - |

**å…³é”®**: Quamba2çš„SRAMå¼€é”€æ˜¯Quamba1çš„**288å€**ï¼

### åŠŸè€—å¼€é”€

| æ–¹æ¡ˆ | Per-lookupåŠŸè€— | ç›¸å¯¹å€¼ |
|------|---------------|--------|
| **Quamba1** | 0.01 nJ | 1Ã— |
| **Quamba2 (é¡ºåº)** | 1 nJ | **100Ã—** |
| **Quamba2 (å¹¶è¡Œ)** | 2 nJ | **200Ã—** |
| **Rotation** | 100 nJ | **10,000Ã—** |

### å»¶è¿Ÿå¼€é”€

| æ–¹æ¡ˆ | å»¶è¿Ÿ | Critical path |
|------|------|--------------|
| **Quamba1** | 1 ns | âœ… ä¸å½±å“ |
| **Quamba2 (é¡ºåº)** | 7.4 ns | âš ï¸ **å¯èƒ½æˆä¸ºç“¶é¢ˆ** |
| **Quamba2 (å¹¶è¡Œ)** | 2 ns | âœ… å¯æ¥å— |
| **Rotation** | 100 ns | âŒ ä¸¥é‡ç“¶é¢ˆ |

---

## ğŸ¯ ASICè®¾è®¡çš„å…³é”®é—®é¢˜

### é—®é¢˜1: SRAMæ˜¯ASICæœ€è´µçš„èµ„æº

**æ•°æ®**:
```
7nmå·¥è‰ºä¸‹:
- 1ä¸ªINT8 MAC: ~0.001 mmÂ²
- 1 KB SRAM: ~0.04 mmÂ²

72 KB SRAM = 72Ã—0.04 = 2.88 mmÂ²
ç­‰ä»·äº: 2880ä¸ªMACå•å…ƒï¼
```

**å½±å“**:
- Quamba2çš„72 KB SRAMå¯ä»¥æ¢æˆ**2880ä¸ªå¹¶è¡ŒMAC**
- è¿™äº›MACå¯ä»¥æ˜¾è‘—æå‡è®¡ç®—ååé‡
- **å­˜å‚¨vsè®¡ç®—çš„æƒè¡¡**

### é—®é¢˜2: å¤šç«¯å£SRAMæ›´è´µ

å¦‚æœç”¨å¹¶è¡ŒæŸ¥æ‰¾ï¼š
```
å•ç«¯å£SRAM: 72 KB Ã— 0.04 mmÂ²/KB = 2.88 mmÂ²
å¤šç«¯å£SRAM (16ç«¯å£): 72 KB Ã— 0.06 mmÂ²/KB = 4.32 mmÂ² (+50%)
```

### é—®é¢˜3: æŸ¥æ‰¾å»¶è¿Ÿå¯èƒ½æˆä¸ºCritical Path

**é¡ºåºæŸ¥æ‰¾**:
```
å»¶è¿Ÿ: 7.4 ns

å‡è®¾ç›®æ ‡é¢‘ç‡: 500 MHz
æ—¶é’Ÿå‘¨æœŸ: 2 ns

æŸ¥æ‰¾éœ€è¦: 7.4 / 2 = 3.7ä¸ªæ—¶é’Ÿå‘¨æœŸ âš ï¸
```

**å½±å“**:
- æµæ°´çº¿éœ€è¦æ’å…¥3-4çº§
- å¢åŠ latency
- å¯èƒ½é™ä½ååé‡

---

## ğŸ’¡ ASICä¼˜åŒ–ç­–ç•¥

### ç­–ç•¥1: å‡å°‘åˆ†ç»„æ•° (é™ä½SRAM)

**å½“å‰**: 8Ã—4Ã—4 = 128ä¸ªscales

**ä¼˜åŒ–**: 8Ã—2Ã—2 = 32ä¸ªscales

```
SRAMå‡å°‘:
- Index: 640 â†’ 160 bytes (-75%)
- Scales: 512 â†’ 128 bytes (-75%)
- æ€»è®¡: 1152 â†’ 288 bytes (-75%)

é¢ç§¯èŠ‚çœ: 2.88 â†’ 0.72 mmÂ² (-75%)
åŠŸè€—èŠ‚çœ: 1 nJ â†’ 0.25 nJ (-75%)

ä»£ä»·: ç²¾åº¦å¯èƒ½ä¸‹é™ï¼ˆéœ€å®éªŒéªŒè¯ï¼‰
```

### ç­–ç•¥2: æŸ¥æ‰¾è¡¨ (LUT) æ›¿ä»£æ¯”è¾ƒ

**åŸç†**:
```verilog
// é¢„è®¡ç®—æ‰€æœ‰å¯èƒ½çš„head_idxå’Œdim_idxç»„åˆ
// ç›´æ¥ç”¨LUTæŸ¥æ‰¾
module lut_scale_lookup (
    input [4:0] head_idx,
    input [4:0] dim_idx,
    output [31:0] scale_out
);
    // 32Ã—32 = 1024ä¸ªentryçš„LUT
    reg [31:0] lut[0:1023];

    assign scale_out = lut[{head_idx, dim_idx}];
endmodule
```

**æˆæœ¬**:
```
LUTå¤§å°: 1024 entries Ã— 4 bytes = 4 KB
ç›¸æ¯”å½“å‰: 4 KB vs 1.152 KB (+3.5Ã—)

ä½†:
- å»¶è¿Ÿ: ~1 ns (å•æ¬¡æŸ¥æ‰¾)
- é€»è¾‘: é›¶ (åªæ˜¯SRAM)
- åŠŸè€—: ~0.1 nJ (å°å¾ˆå¤š)
```

**Trade-off**:
- âœ… å»¶è¿Ÿæœ€ä½ (1 ns)
- âœ… é€»è¾‘æœ€ç®€å•
- âŒ SRAMå¢åŠ 3.5Ã—

### ç­–ç•¥3: æ··åˆæ–¹æ¡ˆ

**æ€è·¯**:
- å¤§éƒ¨åˆ†å±‚ç”¨Quamba1 (per-tensor)
- å…³é”®å±‚ç”¨Quamba2 (piecewise)

**ç¤ºä¾‹** (Mamba2-2.7B, 64å±‚):
```
å‰32å±‚: Quamba1 (0.01 mmÂ² SRAM)
å32å±‚: Quamba2 (2.88 mmÂ² SRAM)

æ€»SRAM: 0.01Ã—32 + 2.88Ã—32 = 0.32 + 92.16 = 92.48 mmÂ²
vs å…¨Quamba2: 2.88Ã—64 = 184.32 mmÂ²

èŠ‚çœ: 50% SRAM
```

---

## ğŸ”¬ ä¸å…¶ä»–ASICåŠ é€Ÿå™¨å¯¹æ¯”

### Google TPU v4

**ç‰¹ç‚¹**:
- çŸ©é˜µè®¡ç®—å•å…ƒï¼š128Ã—128 INT8 systolic array
- ç‰‡ä¸ŠSRAMï¼š~32 MB (HBM buffer)
- é‡åŒ–ï¼šä¸»è¦ç”¨per-tensor scale

**è®¾è®¡å“²å­¦**:
- æœ€å¤§åŒ–è®¡ç®—å¯†åº¦
- SRAMç”¨äºæ•°æ®ç¼“å­˜ï¼Œä¸ç”¨äºå¤§é‡metadata

**å¯¹Quamba2çš„å¯ç¤º**:
- 72 KB indexåœ¨32 MBæ€»SRAMä¸­å 0.2%ï¼ˆå¯æ¥å—ï¼‰
- ä½†TPUä¸åšå¤æ‚çš„runtimeæŸ¥æ‰¾

### NVIDIA Hopper Tensor Core

**ç‰¹ç‚¹**:
- FP8æ”¯æŒï¼ˆç¡¬ä»¶scaleï¼‰
- Per-tensoræˆ–per-block scale
- Scaleå­˜å‚¨ï¼šä¸“ç”¨å°SRAM

**è®¾è®¡å“²å­¦**:
- ç¡¬ä»¶æ”¯æŒscaleï¼Œä½†ç®€å•ï¼ˆper-tensoræˆ–å°blockï¼‰
- é¿å…å¤æ‚æŸ¥æ‰¾é€»è¾‘

---

## ğŸ“Š æœ€ç»ˆç»“è®ºï¼šASICè§’åº¦çš„å¼€é”€è¯„ä¼°

### ç»å¯¹å¼€é”€

| èµ„æº | Quamba1 | Quamba2 | å¢åŠ  |
|------|---------|---------|------|
| **SRAMé¢ç§¯** | 0.01 mmÂ² | 2.88 mmÂ² | **+287Ã—** |
| **é€»è¾‘é¢ç§¯** | ~0 | 0.001 mmÂ² | å¯å¿½ç•¥ |
| **åŠŸè€—/lookup** | 0.01 nJ | 1 nJ | **+100Ã—** |
| **å»¶è¿Ÿ** | 1 ns | 7.4 ns | **+7.4Ã—** |

### ç›¸å¯¹å¼€é”€

**é¢ç§¯** (vs æ•´ä¸ªåŠ é€Ÿå™¨):
```
å‡è®¾å®Œæ•´Mamba ASIC:
- MAC array: ~50 mmÂ² (2048ä¸ªINT8 MAC)
- ç‰‡ä¸ŠSRAM: ~10 mmÂ² (æ€»buffer)
- æ§åˆ¶é€»è¾‘: ~5 mmÂ²
- æ€»è®¡: ~65 mmÂ²

Quamba2 index: 2.88 mmÂ²
ç›¸å¯¹å¼€é”€: 2.88 / 65 = 4.4% âš ï¸
```

**åŠŸè€—** (vs Conv1D):
```
Conv1Dè®¡ç®—: 2 nJ
IndexæŸ¥æ‰¾: 1 nJ
ç›¸å¯¹å¼€é”€: 1 / 2 = 50% âš ï¸âš ï¸âš ï¸
```

**ç»“è®º**: åœ¨ASICä¸Šï¼Œ**Quamba2çš„indexå¼€é”€ä¸å¯å¿½ç•¥**ï¼

---

## ğŸ¯ å¯¹ASICè®¾è®¡çš„å»ºè®®

### 1. å¦‚æœè¿½æ±‚æè‡´æ•ˆç‡

**æ¨è**: **Quamba1 (Per-tensor scale)**
- é¢ç§¯æœ€å°
- åŠŸè€—æœ€ä½
- å»¶è¿Ÿæœ€çŸ­
- è®¾è®¡æœ€ç®€å•

**ä»£ä»·**: ç²¾åº¦æ¯”Quamba2ä½1-2%

### 2. å¦‚æœéœ€è¦æ›´é«˜ç²¾åº¦

**æ¨è**: **ä¼˜åŒ–çš„Quamba2**
- å‡å°‘åˆ†ç»„ï¼š8Ã—2Ã—2 = 32 scales (é™ä½75% SRAM)
- æˆ–ç”¨LUTæŸ¥æ‰¾ (ç®€åŒ–é€»è¾‘)
- æˆ–å¹¶è¡ŒæŸ¥æ‰¾ (é™ä½å»¶è¿Ÿ)

### 3. æ··åˆæ–¹æ¡ˆ

```
å±‚çº§ç­–ç•¥:
- å‰50%å±‚: Quamba1 (å¿«é€Ÿ)
- å50%å±‚: Quamba2 (ç²¾åº¦)

æˆ–

å…³é”®å±‚ç­–ç•¥:
- Attention-heavyå±‚: Quamba2
- å…¶ä»–å±‚: Quamba1
```

---

## ğŸ“ˆ ä¸GPUå®ç°çš„å¯¹æ¯”

| ç»´åº¦ | GPU | ASIC |
|------|-----|------|
| **SRAMæˆæœ¬** | ä¾¿å®œ (MBçº§L1/L2) | **æ˜‚è´µ** (æ¯KBéƒ½è´µ) |
| **æŸ¥æ‰¾å»¶è¿Ÿ** | å¯å¿½ç•¥ (å¤§é‡å¹¶è¡Œ) | **å…³é”®** (å¯èƒ½æ˜¯ç“¶é¢ˆ) |
| **åŠŸè€—é‡è¦æ€§** | ä¸­ç­‰ | **æé«˜** (è¾¹ç¼˜è®¾å¤‡) |
| **Indexå¼€é”€** | <1% | **4-50%** âš ï¸ |

**æ ¸å¿ƒå·®å¼‚**ï¼š
- GPU: Quamba2çš„indexå¼€é”€å¯å¿½ç•¥
- ASIC: Quamba2çš„indexå¼€é”€**æ˜¾è‘—**

---

## ğŸ”¬ è¿›ä¸€æ­¥ç ”ç©¶æ–¹å‘

### 1. è‡ªé€‚åº”åˆ†ç»„

```
æ ¹æ®å±‚çš„é‡è¦æ€§åŠ¨æ€é€‰æ‹©åˆ†ç»„æ•°:
- ç¬¬ä¸€å±‚: 2Ã—2 groups (4ä¸ªscales)
- ä¸­é—´å±‚: 4Ã—4 groups (16ä¸ªscales)
- æœ€åå±‚: 8Ã—4 groups (32ä¸ªscales)

å¯èƒ½èŠ‚çœ50% SRAM
```

### 2. å‹ç¼©Indexè¡¨ç¤º

```
å½“å‰: æ¯ä¸ªrangeç”¨INT32 (32 bits)
ä¼˜åŒ–: ç”¨æ›´å°çš„è¡¨ç¤º
- å‡è®¾æœ€å¤§range < 256 â†’ ç”¨8 bits
- Indexå‹ç¼©4Ã— â†’ SRAMå‡å°‘75%
```

### 3. ç¡¬ä»¶-è½¯ä»¶ååŒè®¾è®¡

```
è½¯ä»¶å±‚é¢:
- è®­ç»ƒæ—¶çº¦æŸscalesçš„åˆ†å¸ƒ
- ä½¿å¾—å¯ä»¥ç”¨æ›´ç®€å•çš„ç¡¬ä»¶æŸ¥æ‰¾

ç¡¬ä»¶å±‚é¢:
- ä¸“ç”¨æŸ¥æ‰¾å•å…ƒ
- ä¼˜åŒ–çš„SRAMå¸ƒå±€
```

---

**åˆ›å»ºæ—¶é—´**: 2025-11-05
**åˆ†æå¯¹è±¡**: ASICç¡¬ä»¶å®ç°
**ç»“è®º**: åœ¨ASICä¸Šï¼ŒQuamba2çš„indexå¼€é”€**æ˜¾è‘—**ï¼ˆé¢ç§¯+287Ã—ï¼ŒåŠŸè€—+100Ã—ï¼‰ï¼Œéœ€è¦æƒè¡¡æˆ–ä¼˜åŒ–ã€‚

